
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Nuts and Bolts of the operations &#8212; ThunderKittens Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Basics/Basics of CUDA';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="ThunderKittens Documentation - Home"/>
    <img src="../_static/logo.png" class="logo__image only-dark pst-js-only" alt="ThunderKittens Documentation - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    ThunderKittens
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Installation%20and%20Setup/Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Installation%20and%20Setup/Getting%20Started.html">Getting started</a></li>



<li class="toctree-l1"><a class="reference internal" href="../Installation%20and%20Setup/Demo.html">TK Demos: play with kittens!</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Basics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="SM.html">SM</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FBasics/Basics of CUDA.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Basics/Basics of CUDA.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Nuts and Bolts of the operations</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Nuts and Bolts of the operations</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#kernel">Kernel</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#grid">Grid</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#block">Block</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#threads">Threads</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-cuda-thread-indexing">Understanding CUDA Thread Indexing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-global-thread-id">Calculating Global Thread ID</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#helper-types-and-functions">Helper Types and Functions</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dim3">dim3</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">&lt;&lt;&lt;&gt;&gt;&gt;</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#memory-management">Memory Management</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cudamalloc">cudaMalloc</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cudamemcpy">cudaMemcpy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cudadevicesynchronize">cudaDeviceSynchronize()</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#some-theory-on-memory">Some theory on Memory</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#putting-it-all-together">Putting It All Together</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="nuts-and-bolts-of-the-operations">
<h1>Nuts and Bolts of the operations<a class="headerlink" href="#nuts-and-bolts-of-the-operations" title="Link to this heading">#</a></h1>
<p>Here are some nuts and bolts of CUDA which will be used countless times in the future</p>
<section id="kernel">
<h2>Kernel<a class="headerlink" href="#kernel" title="Link to this heading">#</a></h2>
<p>A kernel is a special function that runs on your GPU (Graphics Card) instead of your CPU. Think of it like giving instructions to a large team of workers (GPU threads) who can all work at the same time.</p>
</section>
<section id="grid">
<h2>Grid<a class="headerlink" href="#grid" title="Link to this heading">#</a></h2>
<p>The grid represents the entire set of threads launched for a single kernel invocation. Think of it as the overall execution space. It’s a collection of thread blocks.</p>
<p>When you launch a kernel, you specify the dimensions of the grid, essentially defining how many blocks will be created. It can be 1D, 2D, or 3D (like a line, sheet, or cube of blocks). It is used for organizing really large computations</p>
<p>Example: When processing a large image, each block might handle one section of the image</p>
</section>
<section id="block">
<h2>Block<a class="headerlink" href="#block" title="Link to this heading">#</a></h2>
<p>A block is a group of threads that can cooperate and share data quickly through shared <a class="reference external" href="http://memory.It">memory.It</a> also can be 1D, 2D, or 3D</p>
<ul class="simple">
<li><p>Threads within a block can:</p>
<ul>
<li><p>Share memory</p></li>
<li><p>Synchronize with each other</p></li>
<li><p>Cooperate on tasks</p></li>
</ul>
</li>
</ul>
<p>Example: If processing an image, a block might handle a 16x16 pixel region</p>
</section>
<section id="threads">
<h2>Threads<a class="headerlink" href="#threads" title="Link to this heading">#</a></h2>
<p>The thread is the smallest unit of execution in CUDA. Each thread executes the kernel code independently. Within a block, threads are identified by a unique thread ID. This ID allows you to access specific data or perform different operations based on the thread’s position within the block.</p>
<blockquote>
<div><p>Threads have their own unique ID to know which data to work on</p>
</div></blockquote>
</section>
<section id="understanding-cuda-thread-indexing">
<h2>Understanding CUDA Thread Indexing<a class="headerlink" href="#understanding-cuda-thread-indexing" title="Link to this heading">#</a></h2>
<p>In CUDA, Each thread has a unique identifier that can be used to determine its position within the grid and block. The following variables are commonly used for this purpose:</p>
<ol class="arabic simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">threadIdx</span></code></strong>:</p>
<ul class="simple">
<li><p>A 3-component vector (<code class="docutils literal notranslate"><span class="pre">threadIdx.x</span></code>, <code class="docutils literal notranslate"><span class="pre">threadIdx.y</span></code>, <code class="docutils literal notranslate"><span class="pre">threadIdx.z</span></code>) that gives the thread’s position within its block.</p></li>
<li><p>Example: If you have a 1D block of 256 threads, <code class="docutils literal notranslate"><span class="pre">threadIdx.x</span></code> ranges from <code class="docutils literal notranslate"><span class="pre">0</span></code> to <code class="docutils literal notranslate"><span class="pre">255</span></code>.</p></li>
</ul>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">blockDim</span></code></strong>:</p>
<ul class="simple">
<li><p>A 3-component vector (<code class="docutils literal notranslate"><span class="pre">blockDim.x</span></code>, <code class="docutils literal notranslate"><span class="pre">blockDim.y</span></code>, <code class="docutils literal notranslate"><span class="pre">blockDim.z</span></code>) that specifies the dimensions of the block.</p></li>
<li><p>Example: If your block is 256 threads in the x-direction, <code class="docutils literal notranslate"><span class="pre">blockDim.x</span></code> is <code class="docutils literal notranslate"><span class="pre">256</span></code>.</p></li>
</ul>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">blockIdx</span></code></strong>:</p>
<ul class="simple">
<li><p>A 3-component vector (<code class="docutils literal notranslate"><span class="pre">blockIdx.x</span></code>, <code class="docutils literal notranslate"><span class="pre">blockIdx.y</span></code>, <code class="docutils literal notranslate"><span class="pre">blockIdx.z</span></code>) that gives the block’s position within the grid.</p></li>
<li><p>Example: If you have a 1D grid of 10 blocks, <code class="docutils literal notranslate"><span class="pre">blockIdx.x</span></code> ranges from <code class="docutils literal notranslate"><span class="pre">0</span></code> to <code class="docutils literal notranslate"><span class="pre">9</span></code>.</p></li>
</ul>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">gridDim</span></code></strong>:</p>
<ul class="simple">
<li><p>A 3-component vector (<code class="docutils literal notranslate"><span class="pre">gridDim.x</span></code>, <code class="docutils literal notranslate"><span class="pre">gridDim.y</span></code>, <code class="docutils literal notranslate"><span class="pre">gridDim.z</span></code>) that specifies the dimensions of the grid.</p></li>
<li><p>Example: If your grid has 10 blocks in the x-direction, <code class="docutils literal notranslate"><span class="pre">gridDim.x</span></code> is <code class="docutils literal notranslate"><span class="pre">10</span></code>.</p></li>
</ul>
</li>
</ol>
</section>
<section id="calculating-global-thread-id">
<h2>Calculating Global Thread ID<a class="headerlink" href="#calculating-global-thread-id" title="Link to this heading">#</a></h2>
<p>To compute a unique global thread ID (e.g., for accessing elements in a 1D array), you can use the following formula:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">globalThreadId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">blockIdx</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">blockDim</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">blockIdx.x</span> <span class="pre">*</span> <span class="pre">blockDim.x</span></code> gives the starting index of the current block.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">threadIdx.x</span></code> gives the thread’s position within the block.</p></li>
</ul>
<hr class="docutils" />
</section>
</section>
<section id="helper-types-and-functions">
<h1>Helper Types and Functions<a class="headerlink" href="#helper-types-and-functions" title="Link to this heading">#</a></h1>
<section id="dim3">
<h2>dim3<a class="headerlink" href="#dim3" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>A simple way to specify 3D dimensions</p></li>
<li><p>Used for grid and block sizes</p></li>
<li><p>Example:</p></li>
</ul>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">dim3</span><span class="w"> </span><span class="nf">blockSize</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w">  </span><span class="c1">// 16x16x1 threads per block</span>
<span class="n">dim3</span><span class="w"> </span><span class="nf">gridSize</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w">     </span><span class="c1">// 8x8x1 blocks in grid</span>
</pre></div>
</div>
</section>
<section id="id1">
<h2>&lt;&lt;&lt;&gt;&gt;&gt;<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<p>This is used to configure and launch kernels on the GPU. It defines the grid and block dimensions, shared memory size, and stream for kernel execution. Properly configuring these parameters is essential for efficient GPU programming and maximizing performance.</p>
<ul class="simple">
<li><p>Special brackets for launching kernels</p></li>
<li><p>Specifies grid and block dimensions</p></li>
<li><p>Example:</p></li>
</ul>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">addNumbers</span><span class="o">&lt;&lt;&lt;</span><span class="n">gridSize</span><span class="p">,</span><span class="w"> </span><span class="n">blockSize</span><span class="o">&gt;&gt;&gt;</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span>
</pre></div>
</div>
<p>here <code class="docutils literal notranslate"><span class="pre">addNumbers</span></code> is the name of our kernel and <code class="docutils literal notranslate"><span class="pre">gridSize</span></code> and <code class="docutils literal notranslate"><span class="pre">blockSize</span></code> is the size of grid and block and are <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">result</span></code> are the arguments passed to the kernel</p>
<hr class="docutils" />
</section>
</section>
<section id="memory-management">
<h1>Memory Management<a class="headerlink" href="#memory-management" title="Link to this heading">#</a></h1>
<section id="cudamalloc">
<h2>cudaMalloc<a class="headerlink" href="#cudamalloc" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Allocates memory on the GPU</p></li>
<li><p>Similar to regular malloc but for GPU memory</p></li>
<li><p>Example:</p></li>
</ul>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">device_array</span><span class="p">;</span>
<span class="n">cudaMalloc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">device_array</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
</pre></div>
</div>
</section>
<section id="cudamemcpy">
<h2>cudaMemcpy<a class="headerlink" href="#cudamemcpy" title="Link to this heading">#</a></h2>
<p>It can copy from device to host, host to device, or device to device (edge cases)</p>
<ul class="simple">
<li><p>host to device ⇒ CPU to GPU</p></li>
<li><p>device to host ⇒ GPU to CPU</p></li>
<li><p>device to device ⇒ GPU location to different GPU location</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">cudaMemcpyHostToDevice</span></code></strong>, <strong><code class="docutils literal notranslate"><span class="pre">cudaMemcpyDeviceToHost</span></code></strong>, or <strong><code class="docutils literal notranslate"><span class="pre">cudaMemcpyDeviceToDevice</span></code></strong></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cudaFree</span></code> will free memory on the device</p></li>
<li><p>Example:</p></li>
</ul>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">cudaMemcpy</span><span class="p">(</span><span class="n">device_array</span><span class="p">,</span><span class="w"> </span><span class="n">host_array</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">),</span><span class="w"> </span><span class="n">cudaMemcpyHostToDevice</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="cudadevicesynchronize">
<h2>cudaDeviceSynchronize()<a class="headerlink" href="#cudadevicesynchronize" title="Link to this heading">#</a></h2>
<p>By Defaukt CPU and GPU work together to minimise time but sometimes we need to make CPU wait until all GPU operations are complete. there we use <code class="docutils literal notranslate"><span class="pre">cudaDeviceSynchronize()</span></code>.</p>
<ul class="simple">
<li><p>Useful when you need results before continuing</p></li>
<li><p>We will use it while performing benchmarks</p></li>
<li><p>Example:</p></li>
</ul>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">kernel</span><span class="o">&lt;&lt;&lt;</span><span class="n">gridSize</span><span class="p">,</span><span class="w"> </span><span class="n">blockSize</span><span class="o">&gt;&gt;&gt;</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
<span class="n">cudaDeviceSynchronize</span><span class="p">();</span><span class="w">  </span><span class="c1">// Wait for kernel to finish</span>
<span class="n">printf</span><span class="p">(</span><span class="s">&quot;Kernel completed!&quot;</span><span class="p">);</span>
</pre></div>
</div>
<hr class="docutils" />
</section>
</section>
<section id="some-theory-on-memory">
<h1>Some theory on Memory<a class="headerlink" href="#some-theory-on-memory" title="Link to this heading">#</a></h1>
<p>CUDA provides several types of memory, each with different speeds and uses:</p>
<ol class="arabic simple">
<li><p><strong>Global Memory</strong>:</p>
<ul class="simple">
<li><p>The main memory of the GPU, accessible by all threads.</p></li>
<li><p><strong>Slowest</strong> but <strong>largest</strong> in size.</p></li>
<li><p>Use for data shared across all threads.</p></li>
<li><p>Example: Arrays or large datasets.</p></li>
</ul>
</li>
<li><p><strong>Shared Memory</strong>:</p>
<ul class="simple">
<li><p>Memory shared by all threads in a <strong>block</strong>.</p></li>
<li><p><strong>Very fast</strong> but <strong>small</strong> in size.</p></li>
<li><p>Use for data that threads in a block need to share frequently.</p></li>
<li><p>Example: Temporary variables or small lookup tables.</p></li>
</ul>
</li>
<li><p><strong>Registers</strong>:</p>
<ul class="simple">
<li><p>Fastest memory, private to each <strong>thread</strong>.</p></li>
<li><p>Used for local variables.</p></li>
<li><p>Limited in number, so use wisely.</p></li>
<li><p>Example: Loop counters or intermediate calculations.</p></li>
</ul>
</li>
<li><p><strong>Constant Memory</strong>:</p>
<ul class="simple">
<li><p>Read-only memory for all threads.</p></li>
<li><p>Cached for fast access.</p></li>
<li><p>Use for data that doesn’t change during kernel execution.</p></li>
<li><p>Example: Constants or configuration parameters.</p></li>
</ul>
</li>
<li><p><strong>Local Memory</strong>:</p>
<ul class="simple">
<li><p>Used when registers are not enough (spilling).</p></li>
<li><p><strong>Slow</strong> (stored in global memory).</p></li>
<li><p>Avoid if possible.</p></li>
<li><p>Example: Large arrays or variables that don’t fit in registers.</p></li>
</ul>
</li>
</ol>
<hr class="docutils" />
</section>
<section id="putting-it-all-together">
<h1>Putting It All Together<a class="headerlink" href="#putting-it-all-together" title="Link to this heading">#</a></h1>
<p>Here’s a simple example that brings these concepts together:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Kernel definition</span>
<span class="n">__global__</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">addArrays</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">size</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Calculate unique index for this thread</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">blockIdx</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">blockDim</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
<span class="w">    </span>
<span class="w">    </span><span class="c1">// Make sure we don&#39;t go past array bounds</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">index</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">size</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">c</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// In main function:</span>
<span class="n">dim3</span><span class="w"> </span><span class="n">blockSize</span><span class="p">(</span><span class="mi">256</span><span class="p">);</span><span class="w">  </span><span class="c1">// 256 threads per block</span>
<span class="n">dim3</span><span class="w"> </span><span class="n">gridSize</span><span class="p">((</span><span class="n">size</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">blockSize</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">blockSize</span><span class="p">.</span><span class="n">x</span><span class="p">);</span><span class="w">  </span><span class="c1">// Calculate needed blocks</span>
<span class="n">addArrays</span><span class="o">&lt;&lt;&lt;</span><span class="n">gridSize</span><span class="p">,</span><span class="w"> </span><span class="n">blockSize</span><span class="o">&gt;&gt;&gt;</span><span class="p">(</span><span class="n">d_a</span><span class="p">,</span><span class="w"> </span><span class="n">d_b</span><span class="p">,</span><span class="w"> </span><span class="n">d_c</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">);</span>
</pre></div>
</div>
<p>This example shows how threads are organized to perform parallel addition of two arrays. Each thread handles one element, and we use block and grid dimensions to make sure we cover the entire array.</p>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Basics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Nuts and Bolts of the operations</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#kernel">Kernel</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#grid">Grid</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#block">Block</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#threads">Threads</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-cuda-thread-indexing">Understanding CUDA Thread Indexing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-global-thread-id">Calculating Global Thread ID</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#helper-types-and-functions">Helper Types and Functions</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dim3">dim3</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">&lt;&lt;&lt;&gt;&gt;&gt;</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#memory-management">Memory Management</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cudamalloc">cudaMalloc</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cudamemcpy">cudaMemcpy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cudadevicesynchronize">cudaDeviceSynchronize()</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#some-theory-on-memory">Some theory on Memory</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#putting-it-all-together">Putting It All Together</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By HazyResearch
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>